{"code":"import { creepHelpers } from 'helpers.role';\r\nvar _ = require('lodash');\r\nexport var roleCarrier = {\r\n    run: function (creep) {\r\n        creepHelpers.isWorking(creep);\r\n        if (creep.memory.working) {\r\n            var targets = creep.room.find(FIND_STRUCTURES, {\r\n                filter: function (structure) {\r\n                    return (structure.structureType == STRUCTURE_TOWER ||\r\n                        structure.structureType == STRUCTURE_EXTENSION ||\r\n                        structure.structureType == STRUCTURE_SPAWN) && structure.energy < structure.energyCapacity;\r\n                }\r\n            });\r\n            if (targets.length == 0) {\r\n                targets = creep.room.find(FIND_STRUCTURES, {\r\n                    filter: function (structure) {\r\n                        return (structure.structureType == STRUCTURE_STORAGE);\r\n                    }\r\n                });\r\n            }\r\n            targets = _.sortBy(targets, function (s) { return creep.pos.getRangeTo(s); });\r\n            if (targets.length > 0) {\r\n                if (creep.transfer(targets[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {\r\n                    creep.moveTo(targets[0], { visualizePathStyle: { stroke: '#ffffff' } });\r\n                }\r\n            }\r\n            if (creep.carry.GO) {\r\n                targets = creep.room.find(FIND_STRUCTURES, {\r\n                    filter: function (structure) {\r\n                        return (structure.structureType == STRUCTURE_STORAGE);\r\n                    }\r\n                });\r\n                if (creep.transfer(targets[0], RESOURCE_GHODIUM_OXIDE) == ERR_NOT_IN_RANGE) {\r\n                    creep.moveTo(targets[0], { visualizePathStyle: { stroke: '#ffffff' } });\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (creep.room.find(FIND_DROPPED_RESOURCES).length > 0) {\r\n                creepHelpers.pickupResources(creep);\r\n            }\r\n            else if (creep.room.find(FIND_TOMBSTONES).filter(function (t) { return _.sum(t.store) > 0; }).length > 0) {\r\n                creepHelpers.pickupToumbstones(creep);\r\n            }\r\n            else {\r\n                creepHelpers.extractFromContainer(creep);\r\n            }\r\n        }\r\n    }\r\n};\r\n//# sourceMappingURL=role.carrier.js.map","map":{"version":3,"file":"role.carrier.js","sourceRoot":"","sources":["src/role.carrier.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,YAAY,EAAC,MAAM,cAAc,CAAC;AAC1C,IAAI,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;AAE1B,MAAM,CAAC,IAAM,WAAW,GAAG;IACvB,GAAG,EAAE,UAAS,KAAY;QACtB,YAAY,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QAE9B,IAAI,KAAK,CAAC,MAAM,CAAC,OAAO,EAAE;YACtB,IAAI,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;gBAC3C,MAAM,EAAE,UAAC,SAAS;oBACd,OAAO,CACH,SAAS,CAAC,aAAa,IAAI,eAAe;wBAC1C,SAAS,CAAC,aAAa,IAAI,mBAAmB;wBAC9C,SAAS,CAAC,aAAa,IAAI,eAAe,CACzC,IAAI,SAAS,CAAC,MAAM,GAAG,SAAS,CAAC,cAAc,CAAC;gBACzD,CAAC;aACJ,CAAC,CAAC;YACH,IAAG,OAAO,CAAC,MAAM,IAAI,CAAC,EAAC;gBACnB,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;oBACvC,MAAM,EAAE,UAAC,SAAS;wBACd,OAAO,CACH,SAAS,CAAC,aAAa,IAAI,iBAAiB,CAAC,CAAE;oBACvD,CAAC;iBACJ,CAAC,CAAC;aACN;YAED,OAAO,GAAG,CAAC,CAAC,MAAM,CAAC,OAAO,EAAC,UAAC,CAAe,IAAK,OAAA,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,EAAvB,CAAuB,CAAC,CAAA;YAExE,IAAG,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;gBACnB,IAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,eAAe,CAAC,IAAI,gBAAgB,EAAE;oBAChE,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,EAAC,kBAAkB,EAAE,EAAC,MAAM,EAAE,SAAS,EAAC,EAAC,CAAC,CAAC;iBACvE;aACJ;YAED,IAAG,KAAK,CAAC,KAAK,CAAC,EAAE,EAAC;gBACd,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;oBACvC,MAAM,EAAE,UAAC,SAAS;wBACd,OAAO,CACH,SAAS,CAAC,aAAa,IAAI,iBAAiB,CAAC,CAAE;oBACvD,CAAC;iBACJ,CAAC,CAAC;gBACH,IAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,sBAAsB,CAAC,IAAI,gBAAgB,EAAE;oBACvE,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,EAAC,kBAAkB,EAAE,EAAC,MAAM,EAAE,SAAS,EAAC,EAAC,CAAC,CAAC;iBACvE;aACJ;SACJ;aACI;YACD,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBACpD,YAAY,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;aACvC;iBAAM,IAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,GAAC,CAAC,EAAhB,CAAgB,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBACjF,YAAY,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;aAEzC;iBAAM;gBACH,YAAY,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;aAC5C;SACJ;IACL,CAAC;CACJ,CAAC"}}
